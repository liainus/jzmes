<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>物料追溯</title>
    <link rel="stylesheet" href="../static/css/bootstrap.min.css" crossorigin="anonymous">
    <link rel="stylesheet" href="../static/css/bootstrap-datetimepicker.min.css" crossorigin="anonymous">
    <script type="text/javascript" src="../static/js/jquery.min.js"></script>
    <script type="text/javascript" src="../static/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../static/js/bootstrap-datetimepicker.min.js"></script>
    <style>
        /*横向时间轴*/
        .floatLeft{
            float: left;
        }
        .progress-left{
            position: relative;
            width: 590px;
            padding:20px 0 20px 240px;
            clear: both;
            overflow: hidden;
        }
        .progress-center{
            position: relative;
            float: left;
            width: 310px;
            margin-top: 40px;
            height:140px;
            padding:20px;
            clear: both;
            overflow: hidden;
        }
        .progress-right{
            position: relative;
            float: left;
            width: 310px;
            margin-top: 135px;
            height:46px;
            padding:20px;
            clear: both;
        }
        .progress-right-cc{
            position: relative;
            float: left;
            width: 310px;
            height:90px;
            padding:20px;
            clear: both;
        }
        .host-progress{
            position: relative;
        }
        .host-ball{
            float: left;
            width: 50px;
            height: 50px;
            line-height: 50px;
            border-radius: 50%;
            background-color: #2e8cbc;
            color: #fff;
            text-align: center;
            white-space: nowrap;
        }
        .host-pane{
            float: left;
            width: 150px;
            height: 50px;
            line-height: 50px;
            border-radius: 3px;
            background-color: #e58532;
            color: #fff;
            text-align: center;
            white-space: nowrap;
        }
        .host-pane-gz{
            float: left;
            width: 150px;
            height: 50px;
            line-height: 50px;
            border-radius: 3px;
            background-color: #49d3ca;
            color: #fff;
            text-align: center;
            white-space: nowrap;
        }
        .host-pane-cc{
            float: left;
            width: 150px;
            height: 50px;
            line-height: 50px;
            border-radius: 3px;
            background-color: #7e62a9;
            color: #fff;
            text-align: center;
            white-space: nowrap;
        }
        .ball-right{
            margin-right: 10px;
            background-color: #64c9ed;
        }
        .host-line{
            position: relative;
            float: left;
            width: 120px;
            height: 2px;
            margin-top: 25px;
            background-color: #9F9F9F;
            z-index: 3;
        }
        .host-line-merge{
            position: relative;
            float: left;
            width: 120px;
            height: 2px;
            margin-top: 25px;
            background-color: #9F9F9F;
            z-index: 3;
        }
        .host-dashed{
            border-top:1px dashed #eee;
            height:1px;
        }
        .host-arrow,.host-arrow-merge{
            position: relative;
        }
        .host-arrow:after,.host-arrow:before{
            width: 0;
            height: 0;
            border: 10px solid transparent;
            border-left-color: #9f9f9f;
            position: absolute;
            content: "";
            top: 16px;
            left:160px;
        }
        .host-arrow-merge:after,.host-arrow-merge:before{
            width: 0;
            height: 0;
            border: 10px solid transparent;
            border-left-color: #9f9f9f;
            position: absolute;
            content: "";
            top: 16px;
            left:110px;
        }
        .host-arrow:before{
            top: 16px;
            left: 157px;
            border-left-color: white;
            z-index: 2;
        }
        .host-arrow-merge:before{
            top: 16px;
            left: 107px;
            border-left-color: white;
            z-index: 2;
        }
        .host-message{
            position: absolute;
            top:-15px;
            left:-220px;
            border:1px solid #ddd;
            height:80px;
            width:200px;
            padding:10px;
        }
        .host-message-cc{
            position: absolute;
            top:-15px;
            right:-220px;
            border:1px solid #ddd;
            height:80px;
            width:200px;
            padding:10px;
        }
        .host-message p{
            margin:0;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

    </style>
    <script>
        $(function(){
            $('#beginTimeDate,#endTimehDate').datetimepicker({
                format: 'yyyy-mm-dd',
                startView: 2,
		        minView: 2,
                autoclose: true
            });
            $("#beginTimeDate,#endTimehDate").datetimepicker("setDate", new Date());

            var brand = ""
            $("#seachBatch").on('click',function(){
                if($("#BatchName").find("option:selected").html() == "健胃消食片浸膏粉"){
                    brand = "A"
                }else if($("#BatchName").find("option:selected").html() == "肿节风浸膏"){
                    brand = "B"
                }
                $.ajax({
                    url:'/BatchMaterialTracing/GetData',
                    type:'get',
                    data:{
                        beginTime:$('#beginTimeDate').data("datetimepicker").getDate(),
                        endTime:$('#endTimehDate').data("datetimepicker").getDate(),
                        brand:$("#BatchName").find("option:selected").html()
                    },
                    success:function(data){
                        data = JSON.parse(data)
                        $("#batch").html("<option>请选择</option>")
                        for (var i = 0; i < data.batchs.length; i++) {
                            $("#batch").append("<option>"+ data.batchs[i] + "</option>")
                        }
                    }
                })
            })
            $("#batch").on('change',function(){
                $.ajax({
                    url:'/BatchMaterialTracing/BatchData',
                    type:'get',
                    data:{
                        batch:$(this).find("option:selected").html(),
                        brand:brand
                    },
                    beforeSend:function(XMLHttpRequest){
                        if(brand == "A"){
                            $("#loadingModal1").modal('show');
                        }else if(brand == "B"){
                            $("#loadingModal2").modal('show');
                        }
                    },
                    success:function(data){
                        $("#loadingModal1").modal('hide');
                        $("#loadingModal2").modal('hide');
                        data = JSON.parse(data)
                        for(var key in data){
                            adddata(key,data[key])
                        }
                    }
                })
            })
            function adddata(ids,res){
                $("#" + ids).html(res)
            }
        })
    </script>
</head>
<body>
    <div class="modal" id="loadingModal1">
        <div style="width: 200px;height:20px; z-index: 20000; position: absolute; text-align: center; left: 50%; top: 50%;margin-left:-100px;margin-top:-10px">
            <div class="progress progress-striped active" style="margin-bottom: 0;">
                <div class="progress-bar" style="width: 100%;"></div>
            </div>
            <h5>正在加载健胃消食片的物料信息。。。</h5>
        </div>
    </div>
    <div class="modal" id="loadingModal2">
        <div style="width: 200px;height:20px; z-index: 20000; position: absolute; text-align: center; left: 50%; top: 50%;margin-left:-100px;margin-top:-10px">
            <div class="progress progress-striped active" style="margin-bottom: 0;">
                <div class="progress-bar" style="width: 100%;"></div>
            </div>
            <h5>正在加载肿节风浸膏的物料信息。。。</h5>
        </div>
    </div>
    <div class="container">
        <div class="page-header">
            <div class="form-inline">
                <div class="form-group clearfix">
                    <label for="" class="control-label">选择品名：</label>
                    <select id="BatchName" class="form-control">
                        {% for brand in brands %}
                            <option>{{ brand[0] }}</option>
                        {% endfor %}
                    </select>
                    <label for="" class="control-label"> 开始时间：</label>
                    <input type="text" class="form-control" id="beginTimeDate">
                    <label for="" class="control-label"> 结束时间：</label>
                    <input type="text" class="form-control" id="endTimehDate">
                    <button class="btn btn-primary" id="seachBatch"> 查询批次号</button>
                    <select id="batch" class="form-control">
                        <option value="">请选择</option>
                    </select>
                </div>
            </div>
        </div>
    </div>
    <div style="padding: 0 20px;">
        <div class="floatLeft">
            <!--健胃消食片-->
            <div class="progress-left">
                <div class="host-progress">
                    <div class="host-ball">TQ01</div>
                    <div class="host-line"></div>
                    <div class="host-arrow"></div>
                    <div class="host-message">
                        <p>投料量：<span id="a1"></span></p>
                        <p>第一次加入6倍水：<span id="a2"></span></p>
                        <p>第二次加入5倍水：<span id="a3"></span></p>
                    </div>
                </div>
                <div class="host-progress">
                    <div class="host-ball ball-right">JZ0101</div>
                    <div class="host-ball ball-right">JZ0102</div>
                    <div class="host-ball ball-right">JZ0103</div>
                </div>
            </div>
            <div class="progress-left">
                <div class="host-progress">
                    <div class="host-ball">TQ02</div>
                    <div class="host-line"></div>
                    <div class="host-arrow"></div>
                    <div class="host-message">
                        <p>投料量：<span id="b1"></span></p>
                        <p>第一次加入6倍水：<span id="b2"></span></p>
                        <p>第二次加入5倍水：<span id="b3"></span></p>
                    </div>
                </div>
                <div class="host-progress">
                    <div class="host-ball ball-right">JZ0201</div>
                    <div class="host-ball ball-right">JZ0202</div>
                    <div class="host-ball ball-right">JZ0203</div>
                </div>
            </div>
            <div class="progress-left">
                <div class="host-progress">
                    <div class="host-ball">TQ03</div>
                    <div class="host-line"></div>
                    <div class="host-arrow"></div>
                    <div class="host-message">
                        <p>投料量：<span id="c1"></span></p>
                        <p>第一次加入6倍水：<span id="c2"></span></p>
                        <p>第二次加入5倍水：<span id="c3"></span></p>
                    </div>
                </div>
                <div class="host-progress">
                    <div class="host-ball ball-right">JZ0301</div>
                    <div class="host-ball ball-right">JZ0302</div>
                    <div class="host-ball ball-right">JZ0303</div>
                </div>
            </div>
            <div class="progress-left">
                <div class="host-progress">
                    <div class="host-ball">TQ04</div>
                    <div class="host-line"></div>
                    <div class="host-arrow"></div>
                    <div class="host-message">
                        <p>投料量：<span id="d1"></span></p>
                        <p>第一次加入6倍水：<span id="d2"></span></p>
                        <p>第二次加入5倍水：<span id="d3"></span></p>
                    </div>
                </div>
                <div class="host-progress">
                    <div class="host-ball ball-right">JZ0401</div>
                    <div class="host-ball ball-right">JZ0402</div>
                    <div class="host-ball ball-right">JZ0403</div>
                </div>
            </div>
            <div class="progress-left">
                <div class="host-progress">
                    <div class="host-ball">TQ05</div>
                    <div class="host-line"></div>
                    <div class="host-arrow"></div>
                    <div class="host-message">
                        <p>投料量：<span id="e1"></span></p>
                        <p>第一次加入6倍水：<span id="e2"></span></p>
                        <p>第二次加入5倍水：<span id="e3"></span></p>
                    </div>
                </div>
                <div class="host-progress">
                    <div class="host-ball ball-right">JZ0501</div>
                    <div class="host-ball ball-right">JZ0502</div>
                    <div class="host-ball ball-right">JZ0503</div>
                </div>
            </div>
            <div class="progress-left">
                <div class="host-progress">
                    <div class="host-ball">TQ06</div>
                    <div class="host-line"></div>
                    <div class="host-arrow"></div>
                    <div class="host-message">
                        <p>投料量：<span id="f1"></span></p>
                        <p>第一次加入6倍水：<span id="f2"></span></p>
                        <p>第二次加入5倍水：<span id="f3"></span></p>
                    </div>
                </div>
                <div class="host-progress">
                    <div class="host-ball ball-right">JZ0601</div>
                    <div class="host-ball ball-right">JZ0602</div>
                    <div class="host-ball ball-right">JZ0603</div>
                </div>
            </div>
            <!--间隔线-->
            <div class="progress-left">
                <div class="host-dashed"></div>
            </div>
            <!--草珊瑚含片-->
            <div class="progress-left">
                <div class="host-progress">
                    <div class="host-ball">TQ07</div>
                    <div class="host-line"></div>
                    <div class="host-arrow"></div>
                    <div class="host-message">
                        <p>投料量：<span id="g1"></span></p>
                        <p>第一次加入17倍水：<span id="g2"></span></p>
                        <p>第二次加入6倍水：<span id="g3"></span></p>
                    </div>
                </div>
                <div class="host-progress">
                    <div class="host-ball ball-right">JZ0701</div>
                    <div class="host-ball ball-right">JZ0702</div>
                    <div class="host-ball ball-right">JZ0703</div>
                </div>
            </div>
            <div class="progress-left">
                <div class="host-progress">
                    <div class="host-ball">TQ08</div>
                    <div class="host-line"></div>
                    <div class="host-arrow"></div>
                    <div class="host-message">
                        <p>投料量：<span id="h1"></span></p>
                        <p>第一次加入17倍水：<span id="h2"></span></p>
                        <p>第二次加入6倍水：<span id="h3"></span></p>
                    </div>
                </div>
                <div class="host-progress">
                    <div class="host-ball ball-right">JZ0801</div>
                    <div class="host-ball ball-right">JZ0802</div>
                    <div class="host-ball ball-right">JZ0803</div>
                </div>
            </div>
            <div class="progress-left">
                <div class="host-progress">
                    <div class="host-ball">TQ09</div>
                    <div class="host-line"></div>
                    <div class="host-arrow"></div>
                    <div class="host-message">
                        <p>投料量：<span id="i1"></span></p>
                        <p>第一次加入17倍水：<span id="i2"></span></p>
                        <p>第二次加入6倍水：<span id="i3"></span></p>
                    </div>
                </div>
                <div class="host-progress">
                    <div class="host-ball ball-right">JZ0901</div>
                    <div class="host-ball ball-right">JZ0902</div>
                    <div class="host-ball ball-right">JZ0903</div>
                </div>
            </div>
            <div class="progress-left">
                <div class="host-progress">
                    <div class="host-ball">TQ10</div>
                    <div class="host-line"></div>
                    <div class="host-arrow"></div>
                    <div class="host-message">
                        <p>投料量：<span id="j1"></span></p>
                        <p>第一次加入17倍水：<span id="j2"></span></p>
                        <p>第二次加入6倍水：<span id="j3"></span></p>
                    </div>
                </div>
                <div class="host-progress">
                    <div class="host-ball ball-right">JZ1001</div>
                    <div class="host-ball ball-right">JZ1002</div>
                    <div class="host-ball ball-right">JZ1003</div>
                </div>
            </div>
        </div>
    </div>
    <!--浓缩罐-->
    <div class="floatLeft">
        <!--健胃消食片-->
        <div class="progress-center">
            <div class="host-progress">
                <div class="host-line-merge"></div>
                <div class="host-arrow-merge"></div>
                <div class="host-pane">NS01</div>
            </div>
        </div>
        <div class="progress-center">
            <div class="host-progress">
                <div class="host-line-merge"></div>
                <div class="host-arrow-merge"></div>
                <div class="host-pane">NS02</div>
            </div>
        </div>
        <div class="progress-center">
            <div class="host-progress">
                <div class="host-line-merge"></div>
                <div class="host-arrow-merge"></div>
                <div class="host-pane">NS02</div>
            </div>
        </div>
        <!--间隔线-->
        <div class="progress-left" style="width: 100%;padding: 20px 0;">
            <div class="host-dashed"></div>
        </div>
        <!--草珊瑚含片-->
        <div class="progress-center">
            <div class="host-progress">
                <div class="host-line-merge"></div>
                <div class="host-arrow-merge"></div>
                <div class="host-pane">NS04</div>
            </div>
        </div>
        <div class="progress-center">
            <div class="host-progress">
                <div class="host-line-merge"></div>
                <div class="host-arrow-merge"></div>
                <div class="host-pane">NS05</div>
            </div>
        </div>
    </div>
    <!--干燥/醇沉-->
    <div class="floatLeft">
        <!--健胃消食片-->
        <div class="progress-right">
            <div class="host-progress">
                <div class="host-line-merge"></div>
                <div class="host-arrow-merge"></div>
                <div class="host-pane-gz">GZ01</div>
            </div>
        </div>
        <div class="progress-right">
            <div class="host-progress">
                <div class="host-line-merge"></div>
                <div class="host-arrow-merge"></div>
                <div class="host-pane-gz">GZ02</div>
            </div>
        </div>
        <!--间隔线-->
        <div class="progress-right" style="width: 100%;padding-top: 62px;">
            <div class="host-dashed"></div>
        </div>
        <!--草珊瑚含片-->
        <div class="progress-right-cc">
            <div class="host-progress">
                <div class="host-line-merge"></div>
                <div class="host-arrow-merge"></div>
                <div class="host-pane-cc">CC01</div>
                <div class="host-message-cc">
                    <p>浓缩液体积：<span id="k1"></span></p>
                    <p>95%乙醇用量：<span id="k2"></span></p>
                </div>
            </div>
        </div>
        <div class="progress-right-cc">
            <div class="host-progress">
                <div class="host-line-merge"></div>
                <div class="host-arrow-merge"></div>
                <div class="host-pane-cc">CC02</div>
                <div class="host-message-cc">
                    <p>浓缩液体积：<span id="l1"></span></p>
                    <p>95%乙醇用量：<span id="l2"></span></p>
                </div>
            </div>
        </div>
        <div class="progress-right-cc">
            <div class="host-progress">
                <div class="host-line-merge"></div>
                <div class="host-arrow-merge"></div>
                <div class="host-pane-cc">CC03</div>
                <div class="host-message-cc">
                    <p>浓缩液体积：<span id="m1"></span></p>
                    <p>95%乙醇用量：<span id="m2"></span></p>
                </div>
            </div>
        </div>
        <div class="progress-right-cc">
            <div class="host-progress">
                <div class="host-line-merge"></div>
                <div class="host-arrow-merge"></div>
                <div class="host-pane-cc">CC04</div>
                <div class="host-message-cc">
                    <p>浓缩液体积：<span id="n1"></span></p>
                    <p>95%乙醇用量：<span id="n2"></span></p>
                </div>
            </div>
        </div>
    </div>
</body>
</html>